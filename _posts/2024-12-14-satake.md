---
layout: posts
title:  "Satake isomorphism(s)"
date:   2024-12-14
categories: jekyll update
tags: math
---

I found that I still don't fully understand what Satake isomorphism(s) is (are).
Here I try to record the different versions of Satake isomorphisms in literatures and describe how these are related.
Main references are Gross's famous article on Satake isomorphism, Getz and Hahn's GTM book on automorphic representations (Chapter 7), and some other notes (e.g. [Buzzard's note](https://www.ma.imperial.ac.uk/~buzzard/maths/research/notes/functoriality_of_satake_iso.pdf)).

### Setup

Let $F$ be a nonarchimedean local field with ring of integers $\mathcal{O}$, uniformizer $\varpi$, and the residue field $k = \mathcal{O} / \varpi$ with cardinality $q$.
Let $G$ be a reductive group over $F$.
We even assume that $G$ is *split* for simplicity.
Fix the "pinning" $T \subset B \subset G$, where $T$ (resp. $B$) is a maximal torus (Borel subgroup) of $G$ (all defined over $F$).
Weil group of $T$ is defined as $W = N_G(T) / T$ (here $N_G(T)$ is the normalizer of $T$ in $G$).
As usual, denote the group of characters and cocharacters of $T$ as

$$
\begin{align*}
X^\bullet(T) &= \mathrm{Hom}(T, \mathbb{G}_{m}) \\
X_\bullet(T) &= \mathrm{Hom}(\mathbb{G}_{m}, T)
\end{align*}
$$

which are free abelian groups of rank $l = \mathrm{rank}(T)$, and we have a canonical pairing via composition, valued in $\mathrm{Hom}(\mathbb{G}\_{m}, \mathbb{G}\_{m}) = \mathbb{Z}$.

The main goal of Satake isomorphism is to understand *unramified* representations of $G(F)$.
More precisely, let $\pi$ be a (finite dimensional complex) representation of $G(F)$.
We say that $\pi$ is *unramified* if the space of $K = G(\mathcal{O})$-fixed vectors $\pi^{K}$ is nonzero.
Let $\mathcal{H}\_G = C\_c^{\infty}(K \backslash G(F) / K)$ be the spherical Hecke algebra of $G$, where the multiplication is given by the convolution

$$(f_1 \ast f_2)(g) = \int_{G(F)} f_1(h) f_2(gh^{-1}) \mathrm{d}h.$$

One can describe the multiplication more concretely using the Cartan decomposition.
Let

$$
\begin{align*}
    P^+ &= \{ \lambda \in X_\bullet(T) : \langle \lambda, \alpha \rangle \ge 0 \text{ for all } \alpha \in \Phi^+\} \\
    &= \{ \lambda \in X_\bullet(T) : \langle \lambda, \alpha \rangle \ge 0 \text{ for all } \alpha \in \Delta \}
\end{align*}
$$

be the positive Weyl chamber in $X\_{\bullet}(T)$.
Then we have

$$
    G(F) = \bigsqcup_{\lambda \in P^+} K \lambda(\varpi) K.
$$

This implies that the characteristic functions

$$
    1_{\lambda} := 1_{K\lambda(\varpi) K}, \quad \lambda \in P^+
$$

form a basis of $\mathcal{H}\_{G}$. Multiplication of two basis elements is given by 

$$
1_{\lambda} \cdot 1_{\mu} = \sum_{\nu} n_{\lambda, \mu}(\nu) \cdot 1_\nu
$$

for some $n_{\lambda, \mu}(\nu) \in \mathbb{Z}$.
These integers can be described as a counting problem: if we write

$$
\begin{align*}
    t &= \nu(\varpi) \\
    K \lambda(\varpi) K &:= \bigsqcup_i x_i K \\
    K \mu(\varpi) K &:= \bigsqcup_j y_j K
\end{align*}
$$

then

$$
\begin{align*}
    n_{\lambda, \mu}(\nu) &= (1_{\lambda} \cdot 1_{\mu}) (t) \\
    &= \int_{G(F)} 1_{\lambda}(x) 1_{\nu}(x^{-1}t) \mathrm{d}x \\
    &= \sum_i \int_{x_i K} 1_{\mu} (x^{-1} t) \mathrm{d}x \\
    &= \sum_i \int_{K} 1_\mu(kx^{-1} t) \mathrm{d}k \\
    &= \sum_i 1_{\mu}(x_i^{-1} t) \\
    &= \#\{(i, j) : \nu(\varpi) \in x_i y_j K\}.
\end{align*}
$$

Taking $x_i = \lambda(\varpi)$ and $y_j = \mu(\varpi)$ gives $n_{\lambda, \mu}(\lambda + \mu) \ge 1$; in fact, we have $n_{\lambda, \mu}(\lambda + \mu) = 1$.
Also $n_{\lambda, \mu}(\nu) \ne 0$ only if $\nu \le \lambda + \mu$, hence we get

$$
1_\lambda \cdot 1_\mu = 1_{\lambda + \mu} + \sum_{\nu < \lambda + \mu} n_{\lambda, \mu}(\nu) \cdot 1_{\nu}.
$$

Although it is not obvius from the above calculation, the ring $\mathcal{H}\_G$ is commutative, i.e. $n_{\lambda, \mu}(\nu) = n_{\mu, \lambda}(\nu)$.[^1]
For any unramified representation $\pi$, one can *linearize* it to associate a character of $\mathcal{H}\_{G}$ as

$$\pi(f)v := \int_{G(F)} f(g) \pi(g)v \mathrm{d}g$$

for $f \in \mathcal{H}\_G$.
It can be shown that the dimension of $\pi^K$ is one when $\pi$ is irreducible and unramified, and we get an associated character of the Hecke algebra $\mathrm{tr}\,\pi: \mathcal{H}\_{G} \to \mathbb{C}$.
<!-- , and $\mathcal{H}\_T = C\_c^{\infty}(T(F) / T(\mathcal{O}))$ be the spherical Hecke algebra of $T$. -->



### Satake isomorphism*s*

In the literatures, there are several Satake isomorphism*s* where all of them are connected through different isomorphisms.
All of them (including the unramified local Langlands) combine as a following theorem.

> **Theorem.** (Satake isomorphisms and unramified local Langlands correspondence) We have a bijection among
> 
> 1. Isomorphism classes of unramified irreducible representations of $G(F)$
> 2. Characters of $\mathcal{H}\_{G}$
> 3. Characters of $\mathcal{H}\_{T}^{W}$
> 4. Characters of $\mathbb{C}[X\_{\bullet}(T)]^{W}$
> 5. Characters of $\mathbb{C}[X^{\bullet}(\check{T})]^{W}$
> 6. Conjugacy classes of $\check{G}(\mathbb{C})$

All the missing notations will be defined later.
The correspondence between 1 and 6 is the unramified local Langlands.
1 $\leftrightarrow$ 2 is explained above, and the other bridges (2 to 6, especially 2 to 3 or 4) are essentially Satake isomorphism(s).
Hence Satake isomorphism gives a proof of unramified local Langlands correspondence.

One version of it can be found in Gross's famous article [*On the Satake isomorphism*](https://www.cambridge.org/core/services/aop-cambridge-core/content/view/CEAB94DAAF2C92E62B8E12D347BDA076).

Define $\mathcal{H}\_{T} := C\_{c}^{\infty}(T(F) / T(\mathcal{O}))$ be the spherical Hecke algebra of $T$ (note that $T$ is commutative and the functions in $\mathcal{H}\_{T}$ are bi-$T(\mathcal{O})$-invariant).
It is clear that $\mathcal{H}\_{T}$ is much easier to understand than $\mathcal{H}\_{G}$.

> **Theorem.** (Satake isomorphism) Define a map $\mathcal{S} : \mathcal{H}\_{G} \to \mathcal{H}\_{T}$ as an integral
>
> $$(\mathcal{S}f)(t) = \delta(t)^{\frac{1}{2}} \int_{N(F)} f(tn) \mathrm{d}n = \delta(t)^{-\frac{1}{2}} \int_{N(F)} f(nt) \mathrm{d}n.$$
>
> Then the function is invariant under the action of the Weyl group $W = W(G, T)$ and the map $\mathcal{S}$ defines an algebra isomorphism $$\mathcal{H}_{G} \simeq \mathcal{H}_{T}^{W}.$$

Invariance of $\mathcal{S}f$ under $T(\mathcal{O})$ directly follows from that of $\delta(t)$ and $f$.


To compute $\mathcal{S}$, one can reduce it to a counting problem using Iwasawa decomposition.
For a cocharacter $\lambda \in X\_{\bullet}(T)$, write the double coset $K \lambda(\varpi) K$ as right cosets

$$K \lambda(\varpi) K = \bigsqcup_i x_i K = \bigsqcup_i t(x_i) n(x_i)$$

where $x_i = t(x_i) n(x_i)$ with $t(x_i) \in T(F), n(x_i) \in N(F)$.
Then for $t = \mu(\varpi) \in T(F)$ (with $\mu \in P^+$, the Satake transform of $1\_{\lambda} = 1\_{K\lambda(\varpi) K}$ (evaluated at $t$) is

$$
    \begin{align*}
    \mathcal{S}(1_{\lambda})(t) &= \delta(t)^{\frac{1}{2}} \int_{N(F)} f(tn) \mathrm{d}n \\
    &= q^{-\langle \mu, \rho \rangle} \sum_{i} \int_{N \cap t^{-1} x_i K} \mathrm{d}n \\
    &= q^{-\langle \mu, \rho \rangle} \# \{i : t(x_i) \equiv \mu(\varpi)\pmod{T(\mathcal{O})}\}.
    \end{align*}
$$

When $\mu = \lambda$, we can take $x_i = t(x_i) = \lambda(\varpi)$ and this proves $\mathcal{S}(1\_{\lambda})(\lambda(\varpi)) \ne 0$.
In fact, we have

$$
    \mathcal{S}(1_\lambda)(\lambda(\varpi)) = q^{\langle \lambda, \rho \rangle}.
$$

More generally, $\mathcal{S}(1\_{\lambda})(\mu(\varpi)) \ne 0$ only if $\mu \le \lambda$, and we get

$$
    \mathcal{S}(1_\lambda) = q^{\langle \mu, \rho \rangle} \chi_{\lambda} + \sum_{\mu < \lambda} a_{\lambda}(\mu) \chi_\mu,
$$

where $\chi_\mu$ are the characters of representations of $\check{G}(\mathbb{C})$, with highest weight $\lambda \in X\_{\bullet}(T) = X^{\bullet}(\check{T})$.


### Example

The most famous example would be the case of $G = \mathrm{GL}\_{n}$.
Cartan decomposition of $\mathrm{GL}\_{n}(F)$ is given by

$$\mathrm{GL}_{n}(F) = \bigsqcup_{\lambda_1 \ge \cdots \ge \lambda_n} \mathrm{GL}_{n}(\mathcal{O}) \begin{pmatrix} \varpi^{\lambda_1} & 0 & \cdots & 0 \\ 0 & \varpi^{\lambda_2} & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \cdots & \varpi^{\lambda_n} \end{pmatrix} \mathrm{GL}(\mathcal{O})$$

for integers $\lambda_i$, follows from the theory of elementary divisors (or Smith normal form).
As a $\mathbb{C}$-vector space, the characteristic functions of the double cosets above form a basis, and we will denote it as $1\_{\lambda} = 1\_{(\lambda_1, \dots, \lambda_n)}$.
As a $\mathbb{C}$-algebra, it is generated by $(n+1)$-elements:

$$
\begin{align*}
\lambda_{1^1}&=\lambda_{(1, 0, 0, \dots, 0)}, \\
\lambda_{1^2}&=\lambda_{(1, 1, 0, \dots, 0)}, \\
&\cdots \\
\lambda_{1^n}&=\lambda_{(1, 1, 1, \dots, 1)}, \\
\lambda_{(-1)^{n}}&=\lambda_{(-1, -1, \dots, -1)}.
\end{align*}
$$

Now, choose $\check{T} \le \mathrm{GL}\_{n}(\mathbb{C})$ to be the set of diagonal matrices.
Then for $t \in \check{T}$, we have

$$
\begin{align*}
    \mathcal{S}(\lambda_{(1^r)})(t) &= q^{r(n-r)/2} \mathrm{tr}(\wedge^r t) \\
    \mathcal{S}(\lambda_{(-1)^{n}})(t) &= \det(t^{-1})
\end{align*}
$$

Let's prove this for $n = 2$.


One drawback of the above example is that the dual group of $\mathrm{GL}\_n$ is again $\mathrm{GL}\_n$, and it is not easy to distinguish which is the original $\mathrm{GL}\_n$ and which is the dual of it.
Hence we consider another example from Gross's article: $G = \mathrm{PGL}\_2$, where the dual group is $\check{G} = \mathrm{SL}\_2(\mathbb{C})$.


### Relative Satake transform



[^1]: This follows from the Satake isomorphism, but one can prove it using Gelfond's trick. When $G = \mathrm{GL}\_n$ the commutativity can be shown (without Satake isomorphism) by considering the involution $g \mapsto g^\intercal$ (See Exercise 5.15 of Getz-Hahn), and the point is that similar involution can be defined for more general $G$.